```{r include=FALSE}
# Attach the DeLorean data frame to access members
attach(dl)
```

## Posterior

### Psuedotime

The estimated pseudotime from the best sample against the observed
capture time.
```{r tauBest}
plot(dl, type="pseudotime")
```

The full tau posterior for each cell.
```{r tauPosterior}
ggplot(samples.l$tau, aes(x=cell, y=tau)) + geom_boxplot()
```

### Cell sizes

The posterior for the cell size factors $S_c$:
```{r posteriorS}
(ggplot(samples.l$S, aes(x=S))
    + geom_density()
    + geom_rug()
    + stat_function(fun=function(x) dnorm(x,
                                          mean=hyper$mu_S,
                                          sd=hyper$sigma_S),
                    colour="blue", alpha=.7, linetype="dashed")
)
```

The posterior for the cell size factors by cell:
```{r sizeFactorsByCell}
plot(dl, type="S.posteriors")
```


### Gene means

The posterior for the gene means $\phi_g$:
```{r posteriorPhi}
(ggplot(samples.l$phi, aes(x=phi))
    + geom_density()
    + geom_rug()
    + stat_function(fun=function(x) dnorm(x,
                                          mean=hyper$mu_phi,
                                          sd=hyper$sigma_phi),
                    colour="blue", alpha=.7, linetype="dashed")
)
```

The posterior for the gene means $\phi_g$ by gene:
```{r posteriorPhiByGene}
(ggplot(samples.l$phi,
        aes(x=factor(g), y=phi))
    + geom_boxplot())
```

### Between time variation

The posterior for the between time variation $\psi_g$:
```{r posteriorPsi}
(ggplot(samples.l$psi, aes(x=psi))
    + geom_density()
    + geom_rug()
    + stat_function(fun=function(x) dlnorm(x,
                                           mean=hyper$mu_psi,
                                           sd=hyper$sigma_psi),
                    colour="blue", alpha=.7, linetype="dashed")
)
```

Temporal variation by gene:
```{r temporalVariation}
(ggplot(noise.levels,
        aes(x=gene, y=log(psi), fill=gene %in% genes.high.psi),
        environment=environment())
    + geom_boxplot())
```

### Within time variation

The posterior for the within time variation $\omega_g$:
```{r posteriorOmega}
(ggplot(samples.l$omega, aes(x=omega))
    + geom_density()
    + geom_rug()
    + stat_function(fun=function(x) dlnorm(x,
                                           mean=hyper$mu_omega,
                                           sd=hyper$sigma_omega),
                    colour="blue", alpha=.7, linetype="dashed")
)
```

Within time variation by gene:
```{r measurementNoise}
(ggplot(noise.levels,
        aes(x=gene, y=log(omega), fill=gene %in% genes.high.psi),
        environment=environment())
    + geom_boxplot())
```


### Variation comparisons

The within time variation compared to the temporal variation:
```{r noiseScatter}
(ggplot(noise.levels,
        aes(x=psi, y=omega, color=gene %in% genes.high.psi),
        environment=environment()) + geom_point())
```

Within time variation against temporal variation by gene:
```{r measurementNoiseByGene}
(ggplot(gene.noise.levels,
        aes(x=psi, y=omega, color=gene %in% genes.high.psi),
        environment=environment())
    + geom_point())
```


### Other posteriors

The posterior for the model log probability:
```{r posteriorLP}
(ggplot(samples.l$lp__, aes(x=lp__))
    + geom_density()
    + geom_rug())
```


```{r include=FALSE}
# Detach the previously attached DeLorean data frame
detach(dl)
```
