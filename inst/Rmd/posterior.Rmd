```{r include=FALSE}
# Attach the DeLorean data frame to access members
attach(dl)
```

## Posterior

### Psuedotime

The estimated pseudotime from the best sample against the observed
capture time.
```{r tauBest}
plot(dl, type="pseudotime")
```

The full tau posterior for each cell.
```{r tauPosterior}
ggplot(samples.l$tau, aes(x=cell, y=tau)) + geom_boxplot()
```

### Cell sizes

The posteriors are compared to the priors.

The posterior for the cell size factors $S_c$:
```{r posteriorS}
(qplot(geom="density", x=as.vector(la$S)) + geom_rug()
    + stat_function(fun=function(x) dnorm(x,
                                          mean=hyper$mu_S,
                                          sd=hyper$sigma_S),
                    colour="blue", alpha=.7, linetype="dashed")
)
```

The posterior for the cell size factors by cell:
```{r sizeFactorsByCell}
plot(dl, type="S.posteriors")
```


### Posteriors

The posteriors are compared to the priors.

The posterior for the gene means $\phi_g$:
```{r posteriorPhi}
(qplot(geom="density", x=as.vector(la$phi)) + geom_rug()
    + stat_function(fun=function(x) dnorm(x,
                                          mean=hyper$mu_phi,
                                          sd=hyper$sigma_phi),
                    colour="blue", alpha=.7, linetype="dashed")
)
```

The posterior for the gene means $\phi_g$ by gene:
```{r posteriorPhiByGene}
(ggplot(samples.l$phi,
        aes(x=factor(g), y=phi))
    + geom_boxplot())
```

The posterior for the between time variances $\psi_g$:
```{r posteriorPsi}
(qplot(geom="density", x=as.vector(la$psi)) + geom_rug()
    + stat_function(fun=function(x) dlnorm(x,
                                           mean=hyper$mu_psi,
                                           sd=hyper$sigma_psi),
                    colour="blue", alpha=.7, linetype="dashed")
)
```

The posterior for the within time variances $\omega_g$:
```{r posteriorOmega}
(qplot(geom="density", x=as.vector(la$psi)) + geom_rug()
    + stat_function(fun=function(x) dlnorm(x,
                                           mean=hyper$mu_omega,
                                           sd=hyper$sigma_omega),
                    colour="blue", alpha=.7, linetype="dashed")
)
```


## Other posteriors

The posterior for the model log probability:
```{r posteriorLP}
qplot(geom="density", x=as.vector(la$lp__)) + geom_rug()
```

The measurement noise compared to the temporal variation:
```{r noiseScatter}
(ggplot(noise.levels,
        aes(x=psi, y=omega, color=gene %in% genes.high.psi),
        environment=environment()) + geom_point())
```

Measurement noise by gene:
```{r measurementNoise}
(ggplot(noise.levels,
        aes(x=gene, y=log(omega), fill=gene %in% genes.high.psi),
        environment=environment())
    + geom_boxplot())
```

Temporal variation by gene:
```{r temporalVariation}
(ggplot(noise.levels,
        aes(x=gene, y=log(psi), fill=gene %in% genes.high.psi),
        environment=environment())
    + geom_boxplot())
```

Measurement noise against temporal variation by gene:
```{r measurementNoiseByGene}
(ggplot(gene.noise.levels,
        aes(x=psi, y=omega, color=gene %in% genes.high.psi),
        environment=environment())
    + geom_point())
```

```{r include=FALSE}
# Detach the previously attached DeLorean data frame
detach(dl)
```
