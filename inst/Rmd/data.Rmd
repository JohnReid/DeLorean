```{r echo = FALSE}
library(ggplot2)
library(dplyr)
```


```{r dataAttach, include = FALSE}
# Attach the DeLorean data frame to access members
dl <- analyse.variance(dl, adjust.cell.sizes = FALSE)
attach(dl)
```


## Expression
This data set contains expression data for
`r nrow(dl$expr)` genes and `r ncol(dl$expr)` cells.
The expression values are distributed as
```{r dataDist, echo = FALSE, message = FALSE}
stopifnot(ncol(expr) > 0)
stopifnot(nrow(expr) > 0)
qplot(as.vector(expr))
```


## Cells
Meta data exists for `r nrow(dl$cell.meta)` cells. These were captured at
`r length(levels(cell.meta$capture))` distinct time points.
```{r cellCaptureTimes, echo = FALSE}
ggplot(cell.meta, aes(capture)) + geom_bar()
```

A sample of meta data for the cells:
```{r cellMetaSample, echo = FALSE, results = 'asis'}
knitr::kable(sample_n(cell.meta, 6))
```

### Cell sizes
Estimates of cell sizes by capture time are:
```{r cellSizeEstimates, echo = FALSE}
ggplot(
    cell.sizes %>% left_join(cell.meta, by = c('cell', 'capture')),
    aes(x = capture, y = S.hat)) +
  geom_boxplot()
```
We test if the variation differs across the capture times with a one-way
ANOVA:
```{r cellSizeANOVA}
knitr::kable(broom::tidy(aov(S.hat ~ capture, ungroup(dl$cell.sizes))))
```


## Genes
Violin plots of expression over capture time of some randomly sampled genes.
The red lines show the mean expression at each capture time.
```{r plotGeneData, echo = FALSE}
plot(dl, type = "expr.data")
```

A sample of data for the genes:
```{r geneMetaSample, echo = FALSE, results = 'asis'}
knitr::kable(sample_n(gene.meta, 6))
```


```{r dataDetach, include = FALSE}
# Detach the previously attached DeLorean data frame
detach(dl)
```
